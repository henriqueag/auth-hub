<h2 style="color: var(--p-gray-600)">Listagem de Usuários</h2>

<p-toolbar styleClass="mb-4">
    <ng-template #start>
        <p-iconfield iconPosition="left" class="ml-auto">
            <p-inputicon>
                <i class="fa-solid fa-magnifying-glass"></i>
            </p-inputicon>
            <input
                pInputText
                type="text"
                [ngModel]="query"
                (ngModelChange)="onQueryChange($event)"
                placeholder="Pesquisar"
            />
        </p-iconfield>
    </ng-template>
    <ng-template #end>
        <p-button label="Incluir" icon="fa-solid fa-plus" />
    </ng-template>
</p-toolbar>

<div style="width: 100%; height: calc(100% - 178px)" >
    <p-table [value]="[1, 1, 1, 1, 1]">
        <ng-template #header>
            <tr>
                <th class="p-2"><p-skeleton height="38px"/></th>
                <th class="p-2"><p-skeleton height="38px"/></th>
                <th class="p-2"><p-skeleton height="38px"/></th>
                <th class="p-2"><p-skeleton height="38px"/></th>
                <th class="p-2"><p-skeleton height="38px"/></th>
            </tr>
        </ng-template>
        <ng-template #body>
            <tr>
                <th class="px-1 py-1"><p-skeleton height="30px"/></th>
                <th class="px-1 py-1"><p-skeleton height="30px"/></th>
                <th class="px-1 py-1"><p-skeleton height="30px"/></th>
                <th class="px-1 py-1"><p-skeleton height="30px"/></th>
                <th class="px-1 py-1"><p-skeleton height="30px"/></th>
            </tr>
        </ng-template>
    </p-table>

    <p-table
        dataKey="id"
        [value]="users$.asObservable() | async"
        [loading]="loading$.asObservable() | async"
        [rowHover]="true"
        [paginator]="true"
        [first]="skip"
        [rows]="limit"
        [rowsPerPageOptions]="[5, 10]"
        [totalRecords]="totalRecords$.asObservable() | async"
        [showCurrentPageReport]="true"
        [currentPageReportTemplate]="'Exibindo {first} a {last} de {totalRecords} registros'"
        [scrollable]="true"
        [scrollHeight]="'flex'"
        [lazy]="true"
        (onLazyLoad)="onLazyLoad($event)"
    >
        <ng-template #header>
            <tr>
                <th pSortableColumn="displayName">Nome  <p-sortIcon field="displayName"/></th>
                <th pSortableColumn="username">Nome de usuário  <p-sortIcon field="username"/></th>
                <th pSortableColumn="email">Email  <p-sortIcon field="email"/></th>
                <th pSortableColumn="active">Ativo  <p-sortIcon field="active"/></th>
                <th>Ações</th>
            </tr>
        </ng-template>
        <ng-template #body let-item>
            <tr>
                <td>{{ item.displayName }}</td>
                <td>{{ item.username }}</td>
                <td>{{ item.email }}</td>
                <td>{{ item.active }}</td>
                <td>Ações</td>
            </tr>
        </ng-template>
        <ng-template #emptymessage>
            <tr>
                <td colspan="5">Nenhum usuário encontrado.</td>
            </tr>
        </ng-template>
        <ng-template #loadingbody>

        </ng-template>
    </p-table>
</div>